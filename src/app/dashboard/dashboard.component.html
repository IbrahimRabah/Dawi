<div class="dashboard">
    <!-- Header -->
    <header class="dashboard-header">
        <div class="header-content">
            <h1>{{ getGreeting() }}, {{ (currentUser?.fullName || 'User').split(' ')[0] }}!</h1>
            <p>Here's what's happening at your hospital today.</p>
        </div>
        <div class="header-date">
            <i class="fa-regular fa-calendar"></i>
            <span>{{ 'today' | date:'fullDate' }}</span>
        </div>
    </header>

    <!-- Stats Cards -->
    <section class="stats-section">
        <div class="stats-grid">
            <div class="stat-card animate-fade-in" style="animation-delay: 0.1s">
                <div class="stat-icon">
                    <i class="fa-solid fa-hospital-user"></i>
                </div>
                <div class="stat-content">
                    <span class="stat-value">{{ stats.totalPatients }}</span>
                    <span class="stat-label">Total Patients</span>
                </div>
                <div class="stat-trend up">
                    <i class="fa-solid fa-arrow-trend-up"></i>
                    <span>+12%</span>
                </div>
            </div>

            <div class="stat-card animate-fade-in" style="animation-delay: 0.2s">
                <div class="stat-icon info">
                    <i class="fa-solid fa-calendar-check"></i>
                </div>
                <div class="stat-content">
                    <span class="stat-value">{{ stats.todayAppointments }}</span>
                    <span class="stat-label">Today's Appointments</span>
                </div>
                <div class="stat-progress">
                    <div class="progress-bar"
                        [style.width.%]="(stats.completedToday / stats.todayAppointments) * 100 || 0"></div>
                </div>
            </div>

            <div class="stat-card animate-fade-in" style="animation-delay: 0.3s">
                <div class="stat-icon success">
                    <i class="fa-solid fa-user-doctor"></i>
                </div>
                <div class="stat-content">
                    <span class="stat-value">{{ stats.activeDoctors }}</span>
                    <span class="stat-label">Active Doctors</span>
                </div>
                <div class="stat-badge">
                    <span class="badge badge-success">Online</span>
                </div>
            </div>

            <div class="stat-card animate-fade-in" style="animation-delay: 0.4s">
                <div class="stat-icon warning">
                    <i class="fa-solid fa-clock"></i>
                </div>
                <div class="stat-content">
                    <span class="stat-value">{{ stats.waitingPatients }}</span>
                    <span class="stat-label">Patients Waiting</span>
                </div>
                <div class="stat-pulse" *ngIf="stats.waitingPatients > 0">
                    <span class="pulse-dot"></span>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content Grid -->
    <div class="dashboard-grid">
        <!-- Recent Appointments -->
        <section class="card appointments-card animate-fade-in">
            <div class="card-header">
                <h2>
                    <i class="fa-solid fa-calendar-alt"></i>
                    Recent Appointments
                </h2>
                <a routerLink="/reception/appointments" class="view-all">
                    View All <i class="fa-solid fa-arrow-right"></i>
                </a>
            </div>
            <div class="card-body">
                <div class="appointments-list" *ngIf="recentAppointments.length > 0; else noAppointments">
                    <div class="appointment-item" *ngFor="let apt of recentAppointments; let i = index"
                        [style.animation-delay]="(i * 0.1) + 's'">
                        <div class="appointment-patient">
                            <div class="patient-avatar">
                                <i class="fa-solid fa-user"></i>
                            </div>
                            <div class="patient-info">
                                <span class="patient-name">{{ apt.patient?.fullName || 'Unknown' }}</span>
                                <span class="patient-dept">{{ apt.department?.name || 'N/A' }}</span>
                            </div>
                        </div>
                        <div class="appointment-details">
                            <span class="appointment-time">
                                <i class="fa-regular fa-clock"></i>
                                {{ formatDate(apt.visitDate) }}
                            </span>
                            <span class="appointment-queue">
                                Queue: #{{ apt.queueNumber }}
                            </span>
                        </div>
                        <span class="badge" [ngClass]="getStatusClass(apt.status)">
                            {{ apt.status }}
                        </span>
                    </div>
                </div>
                <ng-template #noAppointments>
                    <div class="empty-state">
                        <i class="fa-solid fa-calendar-xmark"></i>
                        <p>No recent appointments</p>
                    </div>
                </ng-template>
            </div>
        </section>

        <!-- Departments Overview -->
        <section class="card departments-card animate-fade-in">
            <div class="card-header">
                <h2>
                    <i class="fa-solid fa-building-columns"></i>
                    Departments
                </h2>
                <a routerLink="/admin/departments" class="view-all">
                    Manage <i class="fa-solid fa-arrow-right"></i>
                </a>
            </div>
            <div class="card-body">
                <div class="departments-grid">
                    <div class="department-item" *ngFor="let dept of departments; let i = index"
                        [style.animation-delay]="(i * 0.1) + 's'" [style.--dept-color]="dept.colorCode || '#0ea5e9'">
                        <div class="dept-icon">
                            <i class="fa-solid" [ngClass]="dept.icon || 'fa-hospital'"></i>
                        </div>
                        <div class="dept-info">
                            <span class="dept-name">{{ dept.name }}</span>
                            <span class="dept-location">{{ dept.buildingLocation }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Active Doctors -->
        <section class="card doctors-card animate-fade-in">
            <div class="card-header">
                <h2>
                    <i class="fa-solid fa-user-doctor"></i>
                    Active Doctors
                </h2>
                <a routerLink="/admin/doctors" class="view-all">
                    View All <i class="fa-solid fa-arrow-right"></i>
                </a>
            </div>
            <div class="card-body">
                <div class="doctors-list">
                    <div class="doctor-item" *ngFor="let doc of topDoctors; let i = index"
                        [style.animation-delay]="(i * 0.1) + 's'">
                        <div class="doctor-avatar">
                            <i class="fa-solid fa-user-doctor"></i>
                        </div>
                        <div class="doctor-info">
                            <span class="doctor-name">{{ doc.fullName }}</span>
                            <span class="doctor-specialty">{{ doc.specialty?.name || 'Specialist' }}</span>
                        </div>
                        <div class="doctor-status">
                            <span class="status-dot active"></span>
                            <span>Available</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Quick Actions -->
        <section class="card quick-actions-card animate-fade-in">
            <div class="card-header">
                <h2>
                    <i class="fa-solid fa-bolt"></i>
                    Quick Actions
                </h2>
            </div>
            <div class="card-body">
                <div class="actions-grid">
                    <a routerLink="/reception/register" class="action-btn">
                        <i class="fa-solid fa-user-plus"></i>
                        <span>New Patient</span>
                    </a>
                    <a routerLink="/reception/appointments" class="action-btn">
                        <i class="fa-solid fa-calendar-plus"></i>
                        <span>Book Appointment</span>
                    </a>
                    <a routerLink="/reception/queue" class="action-btn">
                        <i class="fa-solid fa-list-ol"></i>
                        <span>Queue Display</span>
                    </a>
                    <a routerLink="/doctor/records" class="action-btn">
                        <i class="fa-solid fa-file-medical"></i>
                        <span>Medical Records</span>
                    </a>
                </div>
            </div>
        </section>
    </div>
</div>